import{r as i,j as e,L as U,U as D,h as $,X as W,z as G,B as Q,m as X,S as E,k as J,l as K,n as S,o as Z,i as q,E as V,F as Y,G as ee,I,P as se,T as te,J as ae,K as re,a as le,u as ie,v as ne,Q as ce}from"./react-vendor-B5RUpvsH.js";import{u as A,C,a as P,b as T,d as b}from"./index-BPJ2Iszk.js";import{N as oe}from"./Navbar-CgXrB6UM.js";import{e as de,d as w,u as O,q as B,j as xe,w as ue,h as L,m as H,l as me,f as he,r as M}from"./firebase-C7cuFLc_.js";import"./vendor-57qY9EKr.js";const ge=()=>{const{user:r}=A(),[g,m]=i.useState(!0),[f,c]=i.useState(!1),[l,o]=i.useState({displayName:"",phone:"",email:""}),[x,d]=i.useState(!1),[p,t]=i.useState(""),[a,n]=i.useState("");i.useEffect(()=>{(async()=>{if(r)try{const h=await de(w(b,"users",r.uid));if(h.exists()){const j=h.data();o({displayName:j.displayName||j.name||"",phone:j.phone||r.phoneNumber||"",email:j.email||r.email||""})}else o({displayName:r.displayName||"",phone:r.phoneNumber||"",email:r.email||""})}catch(h){console.error("Error fetching user data:",h)}finally{m(!1)}})()},[r]);const N=async u=>{u.preventDefault(),c(!0),t(""),n("");try{const h=w(b,"users",r.uid);await O(h,{displayName:l.displayName,email:l.email}),n("Profile updated successfully!"),d(!1)}catch(h){console.error("Error updating profile:",h),t("Failed to update profile.")}finally{c(!1)}};return g?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(U,{className:"animate-spin text-terracotta"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-2xl font-bold text-terracotta flex items-center gap-3",children:[e.jsx(D,{className:"text-terracotta"})," My Profile"]}),!x&&e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 text-sage hover:text-terracotta transition-colors font-bold text-sm bg-white px-4 py-2 rounded-xl shadow-sm border border-sage/10",children:[e.jsx($,{size:16})," Edit"]})]}),e.jsxs(C,{className:"p-8 max-w-2xl bg-white/60",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-8 border-b border-sage/10 pb-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-terracotta to-orange-400 flex items-center justify-center text-white text-3xl font-bold shadow-lg",children:l.displayName?l.displayName.charAt(0).toUpperCase():e.jsx(D,{size:40})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-charcoal",children:l.displayName||"Guest User"}),e.jsx("p",{className:"text-sage font-medium",children:l.phone||"No phone number"})]})]}),p&&e.jsxs("div",{className:"p-3 mb-4 text-red-500 bg-red-50 rounded-lg text-sm font-bold flex items-center gap-2",children:[e.jsx(W,{size:16}),p]}),a&&e.jsxs("div",{className:"p-3 mb-4 text-green-600 bg-green-50 rounded-lg text-sm font-bold flex items-center gap-2",children:[e.jsx(G,{size:16}),a]}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-sage uppercase tracking-widest",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{value:l.displayName,onChange:u=>o({...l,displayName:u.target.value}),disabled:!x,placeholder:"Enter your name",className:"bg-white"}),e.jsx(D,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sage/40",size:18})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-sage uppercase tracking-widest",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{value:l.email,onChange:u=>o({...l,email:u.target.value}),disabled:!x,placeholder:"Enter your email",type:"email",className:"bg-white"}),e.jsx(Q,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sage/40",size:18})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2 opacity-70",children:[e.jsx("label",{className:"text-xs font-bold text-sage uppercase tracking-widest",children:"Phone Number (Read Only)"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{value:l.phone,disabled:!0,className:"bg-gray-50 border-gray-200"}),e.jsx(X,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sage/40",size:18})]}),e.jsx("p",{className:"text-xs text-sage ml-2",children:"Contact support to update phone number."})]})]}),x&&e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-sage/10 mt-6",children:[e.jsx(T,{type:"submit",className:"w-full justify-center",disabled:f,children:f?e.jsx(U,{className:"animate-spin"}):"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),t(""),n("")},className:"w-full py-3 rounded-2xl font-bold text-sage hover:bg-gray-100 transition-colors border border-transparent hover:border-gray-200",children:"Cancel"})]})]})]})]})},pe=()=>{const{user:r}=A(),[g,m]=i.useState([]),[f,c]=i.useState(!0),[l,o]=i.useState(null);i.useEffect(()=>{if(!r)return;const t=B(L(b,"orders"),ue("userId","==",r.uid),xe("createdAt","desc")),a=H(t,n=>{const N=n.docs.map(u=>({id:u.id,...u.data(),createdAt:u.data().createdAt?.toDate()}));m(N),c(!1)});return()=>a()},[r]);const x=t=>{o(l===t?null:t)},d=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"preparing":return"bg-blue-100 text-blue-800 border-blue-200";case"out_for_delivery":return"bg-purple-100 text-purple-800 border-purple-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},p=t=>{switch(t){case"pending":return e.jsx(q,{size:16});case"preparing":return e.jsx(I,{size:16});case"out_for_delivery":return e.jsx(ee,{size:16});case"completed":return e.jsx(Y,{size:16});case"cancelled":return e.jsx(V,{size:16});default:return e.jsx(q,{size:16})}};return f?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-terracotta"})}):g.length===0?e.jsxs("div",{className:"text-center py-20 px-6",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(E,{size:48,className:"text-gray-300"})}),e.jsx("h3",{className:"text-2xl font-bold text-sage mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:"Looks like you haven't placed any orders yet. Check out our menu to get started!"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-terracotta flex items-center gap-3",children:[e.jsx(E,{className:"text-terracotta"})," My Orders"]}),e.jsx("div",{className:"space-y-4",children:g.map(t=>e.jsxs(C,{className:"p-0 overflow-hidden transition-all duration-300 hover:shadow-lg border border-sage/5",children:[e.jsxs("div",{className:"p-6 cursor-pointer flex flex-col md:flex-row md:items-center justify-between gap-4 bg-white/50",onClick:()=>x(t.id),children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-terracotta/10 rounded-xl text-terracotta",children:e.jsx(E,{size:24})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-charcoal text-lg",children:["Order #",t.id.slice(0,8)]}),e.jsxs("p",{className:"text-sage text-sm font-medium",children:[t.createdAt?.toLocaleDateString()," at ",t.createdAt?.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),e.jsx("div",{className:"flex items-center gap-2 mt-2 md:hidden",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border flex items-center gap-2 ${d(t.status)}`,children:[p(t.status),t.status.replace(/_/g," ")]})})]})]}),e.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-6 w-full md:w-auto",children:[e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"font-bold text-sage text-xs uppercase tracking-wider mb-1",children:"Status"}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border flex items-center gap-2 ${d(t.status)}`,children:[p(t.status),t.status.replace(/_/g," ")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-sage text-xs uppercase tracking-wider mb-1",children:"Total"}),e.jsxs("p",{className:"text-xl font-extrabold text-terracotta",children:["$",t.totalAmount?.toFixed(2)]})]}),e.jsx("div",{className:"text-sage",children:l===t.id?e.jsx(J,{size:24}):e.jsx(K,{size:24})})]})]}),l===t.id&&e.jsx("div",{className:"border-t border-sage/10 bg-cream/30 p-6 animate-fade-in",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sage uppercase tracking-wider text-xs mb-4",children:"Items Ordered"}),e.jsx("div",{className:"space-y-3",children:t.items?.map((a,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 overflow-hidden",children:a.image&&e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-charcoal text-sm",children:a.name}),e.jsxs("p",{className:"text-xs text-sage",children:["Qty: ",a.quantity]})]})]}),e.jsxs("p",{className:"font-bold text-terracotta text-sm",children:["$",(a.price*a.quantity).toFixed(2)]})]},n))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sage uppercase tracking-wider text-xs mb-2",children:"Delivery Details"}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white rounded-xl shadow-sm",children:[e.jsx(S,{className:"text-terracotta shrink-0 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-charcoal text-sm",children:t.customerName}),e.jsx("p",{className:"text-sm text-sage",children:t.phone}),e.jsx("p",{className:"text-sm text-sage mt-1 leading-relaxed",children:t.address})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sage uppercase tracking-wider text-xs mb-2",children:"Payment Info"}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white rounded-xl shadow-sm",children:[e.jsx(Z,{className:"text-terracotta",size:18}),e.jsx("p",{className:"font-bold text-charcoal text-sm uppercase",children:t.paymentMethod==="cod"?"Cash On Delivery":"Online Payment"})]})]})]})]})})]},t.id))})]})},be=()=>{const{user:r}=A(),[g,m]=i.useState([]),[f,c]=i.useState(!0),[l,o]=i.useState(!1),[x,d]=i.useState("create"),[p,t]=i.useState(null),[a,n]=i.useState({label:"Home",line1:"",line2:"",city:"",state:"",zip:"",isDefault:!1});i.useEffect(()=>{if(!r)return;const s=L(b,"users",r.uid,"addresses"),y=B(s),v=H(y,k=>{const F=k.docs.map(z=>({id:z.id,...z.data()}));F.sort((z,_)=>(_.isDefault===!0)-(z.isDefault===!0)),m(F),c(!1)});return()=>v()},[r]);const N=async s=>{s.preventDefault(),c(!0);const y=L(b,"users",r.uid,"addresses");if(a.isDefault){const v=g.map(k=>k.isDefault?O(w(b,"users",r.uid,"addresses",k.id),{isDefault:!1}):Promise.resolve());await Promise.all(v)}try{x==="create"?await he(y,{...a,createdAt:M()}):await O(w(b,"users",r.uid,"addresses",p),{...a,updatedAt:M()}),o(!1),j()}catch(v){console.error("Error saving address:",v)}finally{c(!1)}},u=async s=>{if(window.confirm("Are you sure you want to delete this address?"))try{await me(w(b,"users",r.uid,"addresses",s))}catch(y){console.error("Error deleting address:",y)}},h=s=>{n({label:s.label,line1:s.line1,line2:s.line2||"",city:s.city,state:s.state,zip:s.zip,isDefault:s.isDefault||!1}),t(s.id),d("edit"),o(!0)},j=()=>{n({label:"Home",line1:"",line2:"",city:"",state:"",zip:"",isDefault:!1}),d("create"),t(null)},R=s=>{switch(s.toLowerCase()){case"home":return e.jsx(re,{size:18});case"work":return e.jsx(ae,{size:18});default:return e.jsx(S,{size:18})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-terracotta flex items-center gap-3",children:[e.jsx(S,{className:"text-terracotta"})," Saved Addresses"]}),l?e.jsxs(C,{className:"p-6 bg-white max-w-2xl animate-fade-in-up",children:[e.jsx("h3",{className:"text-xl font-bold text-charcoal mb-6",children:x==="create"?"Add New Address":"Edit Address"}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>n({...a,label:"Home"}),className:`py-2 px-4 rounded-xl font-bold text-sm border transition-all ${a.label==="Home"?"bg-terracotta text-white border-terracotta":"bg-white text-sage border-sage/20 hover:border-sage/40"}`,children:"Home"}),e.jsx("button",{type:"button",onClick:()=>n({...a,label:"Work"}),className:`py-2 px-4 rounded-xl font-bold text-sm border transition-all ${a.label==="Work"?"bg-terracotta text-white border-terracotta":"bg-white text-sage border-sage/20 hover:border-sage/40"}`,children:"Work"}),e.jsx("button",{type:"button",onClick:()=>n({...a,label:"Other"}),className:`py-2 px-4 rounded-xl font-bold text-sm border transition-all ${a.label==="Other"?"bg-terracotta text-white border-terracotta":"bg-white text-sage border-sage/20 hover:border-sage/40"}`,children:"Other"})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("input",{placeholder:"Address Line 1",className:"w-full p-3 bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-terracotta focus:ring-1 focus:ring-terracotta/20 transition-all font-medium text-charcoal",value:a.line1,onChange:s=>n({...a,line1:s.target.value}),required:!0}),e.jsx("input",{placeholder:"Address Line 2 (Optional)",className:"w-full p-3 bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-terracotta focus:ring-1 focus:ring-terracotta/20 transition-all font-medium text-charcoal",value:a.line2,onChange:s=>n({...a,line2:s.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx("input",{placeholder:"City",className:"w-full p-3 bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-terracotta focus:ring-1 focus:ring-terracotta/20 transition-all font-medium text-charcoal",value:a.city,onChange:s=>n({...a,city:s.target.value}),required:!0}),e.jsx("input",{placeholder:"State",className:"w-full p-3 bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-terracotta focus:ring-1 focus:ring-terracotta/20 transition-all font-medium text-charcoal",value:a.state,onChange:s=>n({...a,state:s.target.value}),required:!0}),e.jsx("input",{placeholder:"ZIP Code",className:"w-full p-3 bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-terracotta focus:ring-1 focus:ring-terracotta/20 transition-all font-medium text-charcoal md:col-span-1 col-span-2",value:a.zip,onChange:s=>n({...a,zip:s.target.value}),required:!0})]})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer py-2",children:[e.jsx("input",{type:"checkbox",checked:a.isDefault,onChange:s=>n({...a,isDefault:s.target.checked}),className:"w-5 h-5 text-terracotta rounded border-gray-300 focus:ring-terracotta"}),e.jsx("span",{className:"font-bold text-sage text-sm",children:"Set as default address"})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-3 px-6 rounded-xl font-bold text-sage hover:bg-gray-100 transition-colors",children:"Cancel"}),e.jsx(T,{type:"submit",className:"flex-[2] justify-center",children:"Save Address"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{onClick:()=>{j(),o(!0)},className:"border-2 border-dashed border-sage/20 bg-transparent flex items-center justify-center py-6 cursor-pointer hover:border-terracotta hover:bg-white/50 transition-all group",children:e.jsxs("div",{className:"text-sage group-hover:text-terracotta flex items-center gap-2 font-bold",children:[e.jsx(se,{size:20})," Add New Address"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(s=>e.jsxs("div",{className:`bg-white p-5 rounded-2xl shadow-sm border transition-all ${s.isDefault?"border-terracotta ring-1 ring-terracotta/20":"border-sage/10 hover:border-sage/30"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold text-charcoal",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.isDefault?"bg-terracotta text-white":"bg-sage/10 text-sage"}`,children:R(s.label)}),e.jsx("span",{children:s.label}),s.isDefault&&e.jsx("span",{className:"text-xs bg-terracotta/10 text-terracotta px-2 py-0.5 rounded-full ml-2",children:"Default"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(s),className:"p-1.5 hover:bg-gray-100 rounded-lg text-sage hover:text-charcoal transition-colors",children:e.jsx($,{size:16})}),e.jsx("button",{onClick:()=>u(s.id),className:"p-1.5 hover:bg-red-50 rounded-lg text-sage hover:text-red-500 transition-colors",children:e.jsx(te,{size:16})})]})]}),e.jsxs("p",{className:"text-sage text-sm leading-relaxed",children:[s.line1," ",e.jsx("br",{}),s.line2&&e.jsxs(e.Fragment,{children:[s.line2," ",e.jsx("br",{})]}),s.city,", ",s.state," ",s.zip]})]},s.id))})]})]})},we=()=>{const{user:r,logout:g}=A(),m=le(),f=ie(),[c,l]=i.useState("profile");i.useEffect(()=>{m.state&&m.state.tab&&l(m.state.tab)},[m]);const o=async()=>{await g(),f("/")},x=({id:d,icon:p,label:t})=>e.jsxs("button",{onClick:()=>l(d),className:`w-full flex items-center justify-between p-4 rounded-xl transition-all duration-300 font-bold text-left mb-2 group ${c===d?"bg-terracotta text-white shadow-lg":"bg-white text-sage hover:bg-white/80 hover:text-charcoal hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{size:20,className:c===d?"text-white":"text-sage group-hover:text-terracotta transition-colors"}),e.jsx("span",{children:t})]}),c===d&&e.jsx(ce,{size:18,className:"animate-pulse"})]});return e.jsxs("div",{className:"min-h-screen bg-cream",children:[e.jsx(oe,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 md:px-6 pt-32 pb-20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"w-full md:w-72 shrink-0 animate-fade-in-left",children:e.jsxs(C,{className:"p-6 sticky top-32",children:[e.jsxs("div",{className:"text-center mb-8 border-b border-sage/10 pb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-charcoal",children:"My Account"}),e.jsx("p",{className:"text-sage text-sm font-medium mt-1 break-words",children:r?.email||r?.phoneNumber})]}),e.jsxs("nav",{children:[e.jsx(x,{id:"profile",icon:D,label:"My Profile"}),e.jsx(x,{id:"orders",icon:I,label:"My Orders"}),e.jsx(x,{id:"addresses",icon:S,label:"Saved Addresses"}),e.jsx("div",{className:"h-px bg-sage/10 my-4"}),e.jsx("button",{onClick:o,className:"w-full flex items-center justify-between p-4 rounded-xl transition-all duration-300 font-bold text-left text-red-500 hover:bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{size:20}),e.jsx("span",{children:"Logout"})]})})]})]})}),e.jsxs("div",{className:"flex-1 min-w-0 animate-fade-in-up",children:[c==="profile"&&e.jsx(ge,{}),c==="orders"&&e.jsx(pe,{}),c==="addresses"&&e.jsx(be,{})]})]})})]})};export{we as default};
